{% extends "base.html" %}
{% block title %}Products{% endblock %}
{% block content %}
<h1 class="mb-3">Products</h1>

{% if q %}<p class="text-muted">Search results for “{{ q }}”</p>{% endif %}

<div class="row g-3">
  {% for p in items %}
    <div class="col-12 col-md-6 col-lg-4">
      <div class="card h-100">
        {% if p.image_url %}
          <img src="{{ p.image_url }}" class="card-img-top" alt="{{ p.name }}">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ p.name }}</h5>
          <p class="card-text text-muted small flex-grow-1">{{ p.description|truncatechars:120 }}</p>
          <div class="d-flex justify-content-between align-items-center">
            <span class="badge text-bg-primary badge-price">£{{ p.price }}</span>
            <div>
              <a class="btn btn-sm btn-outline-secondary" href="/{{ p.id }}/">Details</a>
              <a class="btn btn-sm btn-primary" href="/cart/add/{{ p.id }}/">Add</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  {% empty %}
    <p>No products yet.</p>
  {% endfor %}
</div>

{% if items.paginator.num_pages > 1 %}
<nav class="mt-4">
  <ul class="pagination">
    {% if items.has_previous %}
      <li class="page-item"><a class="page-link" href="?q={{ q }}&page={{ items.previous_page_number }}">Previous</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Previous</span></li>
    {% endif %}

    <li class="page-item disabled"><span class="page-link">Page {{ items.number }} of {{ items.paginator.num_pages }}</span></li>

    {% if items.has_next %}
      <li class="page-item"><a class="page-link" href="?q={{ q }}&page={{ items.next_page_number }}">Next</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Next</span></li>
    {% endif %}
  </ul>
</nav>
{% endif %}
{% endblock %}